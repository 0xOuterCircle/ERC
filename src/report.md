A report by Ian _k0rean_rand0m_<br>
22/09/22

### IProposalRegistry.sol

-   ~~Однозначно нужна реализация ERC-165~~

-   ~~`IProposalRegistry`<br>
    Не хватает геттеров~~

-   ~~`Transaction.response`<br>
    Необходимо хранить возвращаемое значение `IDappRouter` после завершения выполнения `Transaction`. Это позволит
    последующим приложениям в пайплайне иметь доступ к результатам работы предыдущих `IDappRouter`.~~

-   `Transaction.value`<br>
    Для составления рабочих пайплайнов, нам надо быть уверенным, что перед `Transaction` с не нулевым `value` была
    `Transaction` с его получением из dAppRouter-а хранилища DAO. Поскольку `IProposalRegistry` проксирует ETH в таком
    случае, важно, чтобы он у него был перед выполнением транзакции с `value`. Аналогично встают вопросы по переводам
    ERC20 / ERC721 / ERC1155 из хранилища. Думаю, что необходимо описать интерфейс `IVaultDappRouter` как частного
    случая роутера для управления средствами.

_Для уточнения_

-   `Transaction`<br>
    В `IdAppRouter.vote(...)` / `IdAppRouter.execute(...)` должен передаваться весь пайплайн Transaction[] для доступа
    `IDappRouter` к ответам предшествующих приложений в пайплайне.

-   `vote(uint256 propId, bool decision, bytes calldata data) external`<br>
    В этой функции `data` - кастомные параметры, за которые проголосовал пользователь. Их типы должны получаться из
    соответствующего `IdAppRouter`, а `Transaction` **и** `data` отдаваться в `IdAppRouter.vote(...) -> bytes` при
    голосовании.

### IVotingToken.sol

_Общее_

-   ~~Стоит переименовать в `IGovernance`~~
-   Не хватает геттеров/сеттеров настроек `IGovernance`. Или это оставить на реализацию конкретных приложений, не
    добавлять в стандарт?
-   Нужно заложить возможность реализации токена как наследуемого от ERC20 / ERC721 / ERC1155. Для последнего
    характерно использование `id` токена
-   Для построения сложных структур DAO и управления правами стоит заложить механику `subDAO`, когда `IGovernance`
    является дочерним от другого `провайдера Voting Power`. Кажется, что это не будет лишним именно в стандарте.
-   ~~`balanceOfAt(address _who, uint256 _blockNumber) external returns(uint256)`<br>
    Правильнее назвать эту функцию `votingPowerAt`. Ожидаемо, что не все токены будут реализовывать `Voting Power` от
    баланса - это может быть сделано через стейкинг или как-то иначе. В частности, определение `Voting Power` через
    баланс может ограничивать механики делегирования `Voting Power`. Расчет `Voting Power` от баланса приведет к тому,
    что делегаты будут иметь токены у себя не застейканными и смогут продать/перевести их. Это можно обойти
    нетривиальными путями, вроде ограничений на `transfer` для делегатов, но проще просто оперировать `VotingPower`, а
    не балансом на уровне стандарта и интерфейса~~
-   Делегирование токенов нужно добавить в стандарт - это важнейшая в жизни DAO механика
